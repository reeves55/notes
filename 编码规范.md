# 编码规范



##### ⚠️ ArrayList在使用时一定要设置合适的初始值

```java
// default size 10
List<Object> list = new ArrayList();

// yes
List<Object> list = new ArrayList(initCapacity);
```

如果没有设置合适的初始值，容易导致ArrayList频繁扩容，每次扩容都需要新创建一个数组并把原先数组数据拷贝过去，创建数据的开销、数据拷贝的开销大，还容易引起GC，如果数组较大，分配在老年代，Old GC会导致程序停顿，所以，最好预估ArrayList大小，避免频繁扩容。



ArrayList并发版本是CopyOnWriteArrayList，但是CopyOnWriteArrayList只要有写操作，就复制一份原来的数组开销也太大了，我的想法是在并发情况下，使用CAS操作来让数组的长度增加1，如果数组满了，则用synchronized同步方法让一个线程来执行扩容操作，在数组不满的情况下多个线程写入使用CAS增加count，如果成功，这个位置就是该线程争抢到的可以放入数据的位置，这样可以并发修改这个列表。但是数组的增删改查，如果并发情况下有删除操作，还是不好做的，特此记录一个想法。